<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
<f:view locale="#{index.language}">
	<h:head>
		<title>#{msg['Wallet.Title']}</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				padding: 2em;
				background-color: #f5f5f5;
			}
			.header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 2em;
				padding-bottom: 1em;
				border-bottom: 2px solid #4CAF50;
			}
			.container {
				max-width: 800px;
				margin: 0 auto;
				background-color: white;
				padding: 2em;
				border-radius: 8px;
				box-shadow: 0 2px 4px rgba(0,0,0,0.1);
			}
			.balance-section {
				text-align: center;
				padding: 2em;
				background-color: #4CAF50;
				color: white;
				border-radius: 8px;
				margin-bottom: 2em;
			}
			.balance-amount {
				font-size: 2.5em;
				font-weight: bold;
				margin: 0.5em 0;
			}
			.transaction-section {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 2em;
				margin-top: 2em;
			}
			.transaction-card {
				background-color: #f9f9f9;
				padding: 1.5em;
				border-radius: 8px;
				border: 1px solid #ddd;
			}
			.transaction-card h3 {
				color: #333;
				margin-top: 0;
				margin-bottom: 1em;
			}
			.form-group {
				margin-bottom: 1em;
			}
			.form-group label {
				display: block;
				margin-bottom: 0.5em;
				color: #555;
				font-weight: 500;
			}
			.form-group input {
				width: 100%;
				padding: 0.75em;
				border: 1px solid #ddd;
				border-radius: 4px;
				font-size: 1em;
				box-sizing: border-box;
			}
			.btn-deposit {
				background-color: #4CAF50;
				color: white;
				border: none;
				padding: 0.75em 1.5em;
				border-radius: 4px;
				cursor: pointer;
				font-size: 1em;
				width: 100%;
				font-weight: bold;
			}
			.btn-deposit:hover {
				background-color: #45a049;
			}
			.btn-withdraw {
				background-color: #ff9800;
				color: white;
				border: none;
				padding: 0.75em 1.5em;
				border-radius: 4px;
				cursor: pointer;
				font-size: 1em;
				width: 100%;
				font-weight: bold;
			}
			.btn-withdraw:hover {
				background-color: #fb8c00;
			}
			.btn-back {
				background-color: #2196F3;
				color: white;
				border: none;
				padding: 0.75em 1.5em;
				border-radius: 4px;
				cursor: pointer;
				font-size: 1em;
				margin-top: 2em;
			}
			.btn-back:hover {
				background-color: #0b7dda;
			}
			.message {
				padding: 1em;
				margin-bottom: 1em;
				border-radius: 4px;
				text-align: center;
			}
			.message-success {
				background-color: #d4edda;
				color: #155724;
				border: 1px solid #c3e6cb;
			}
			.message-error {
				background-color: #f8d7da;
				color: #721c24;
				border: 1px solid #f5c6cb;
			}
			.user-info {
				text-align: right;
				color: #666;
			}
			@media (max-width: 768px) {
				.transaction-section {
					grid-template-columns: 1fr;
				}
			}
		</style>
	</h:head>
	<h:body>
		<f:loadBundle basename="Etiquetas" var="msg" />
		
		<!-- Redirect to login if not logged in -->
		<f:metadata>
			<f:event type="preRenderView" listener="#{wallet.checkAuthentication}" />
		</f:metadata>
		
		<div class="container">
			<div class="header">
				<h2>#{msg['Wallet.Title']}</h2>
				<div class="user-info">
					<p>#{msg['Wallet.LoggedInAs']}: <strong>#{login.currentUser.username}</strong></p>
				</div>
			</div>
			
			<h:form id="walletForm">
				<!-- Message Display -->
				<h:panelGroup rendered="#{not empty wallet.message}">
					<div class="message #{wallet.messageType == 'success' ? 'message-success' : 'message-error'}">
						#{wallet.message}
					</div>
				</h:panelGroup>
				
				<!-- Balance Section -->
				<div class="balance-section">
					<h3>#{msg['Wallet.CurrentBalance']}</h3>
					<div class="balance-amount">
						<h:outputText value="#{wallet.currentBalance}">
							<f:convertNumber type="currency" currencySymbol="€" />
						</h:outputText>
					</div>
				</div>
				
				<!-- Transaction Section -->
				<div class="transaction-section">
					<!-- Deposit Card -->
					<div class="transaction-card">
						<h3>#{msg['Wallet.Deposit']}</h3>
						<div class="form-group">
							<label for="depositAmount">#{msg['Wallet.Amount']} (€)</label>
							<h:inputText id="depositAmount" 
							             value="#{wallet.depositAmount}" 
							             required="false"
							             styleClass="form-control">
								<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
							</h:inputText>
						</div>
						<h:commandButton value="#{msg['Wallet.DepositButton']}" 
						                 action="#{wallet.deposit}" 
						                 styleClass="btn-deposit">
							<f:ajax execute="depositAmount" render="walletForm" />
						</h:commandButton>
					</div>
					
					<!-- Withdraw Card -->
					<div class="transaction-card">
						<h3>#{msg['Wallet.Withdraw']}</h3>
						<div class="form-group">
							<label for="withdrawAmount">#{msg['Wallet.Amount']} (€)</label>
							<h:inputText id="withdrawAmount" 
							             value="#{wallet.withdrawAmount}" 
							             required="false"
							             styleClass="form-control">
								<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
							</h:inputText>
						</div>
						<h:commandButton value="#{msg['Wallet.WithdrawButton']}" 
						                 action="#{wallet.withdraw}" 
						                 styleClass="btn-withdraw">
							<f:ajax execute="withdrawAmount" render="walletForm" />
						</h:commandButton>
					</div>
				</div>
				
				<!-- Back Button -->
				<h:commandButton value="#{msg['Wallet.BackToIndex']}" 
				                 action="#{wallet.goToIndex}" 
				                 styleClass="btn-back" />
			</h:form>
		</div>
	</h:body>
</f:view>
</html>
