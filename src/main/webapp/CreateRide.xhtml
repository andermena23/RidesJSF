<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<h:head>
		<title>Create Ride</title>
		<style>
			.message-success {
				padding: 10px;
				margin: 10px 0;
				border-radius: 5px;
				background-color: #d4edda;
				color: #155724;
				border: 1px solid #c3e6cb;
			}
			.message-error {
				padding: 10px;
				margin: 10px 0;
				border-radius: 5px;
				background-color: #f8d7da;
				color: #721c24;
				border: 1px solid #f5c6cb;
			}
			.ui-datepicker {
				font-size: 0.85em;
				width: fit-content !important;
				max-width: fit-content !important;
			}
			.ui-datepicker table {
				border-collapse: collapse;
				width: 100% !important;
			}
			.ui-datepicker td {
				padding: 1px !important;
				text-align: center;
			}
			.ui-datepicker td a, .ui-datepicker td span {
				padding: 5px !important;
				font-size: 0.95em !important;
				width: 30px;
				height: 30px;
				line-height: 20px;
				display: inline-block;
				text-align: center;
			}
			.ui-datepicker th {
				padding: 6px 2px !important;
				font-weight: bold;
				font-size: 0.9em !important;
				text-align: center;
			}
			.ui-datepicker .ui-datepicker-header {
				padding: 4px !important;
				font-size: 0.9em !important;
				position: relative !important;
			}
			.ui-datepicker .ui-datepicker-title {
				display: flex !important;
				align-items: center !important;
				justify-content: flex-start !important;
				gap: 6px;
				padding-left: 35px !important;
			}
			.ui-datepicker .ui-datepicker-month,
			.ui-datepicker .ui-datepicker-year {
				font-size: 0.85em !important;
				padding: 2px 3px !important;
				margin: 0 !important;
				width: auto !important;
				min-width: 60px;
			}
			.ui-datepicker-prev {
				position: absolute !important;
				left: 4px !important;
				top: 50% !important;
				transform: translateY(-50%) !important;
				width: 25px !important;
				height: 25px !important;
				display: flex !important;
				align-items: center !important;
				justify-content: center !important;
			}
			.ui-datepicker-prev span {
				display: flex !important;
				align-items: center !important;
				justify-content: center !important;
			}
			.ui-datepicker-next {
				position: absolute !important;
				right: 4px !important;
				top: 50% !important;
				transform: translateY(-50%) !important;
				width: 25px !important;
				height: 25px !important;
				display: flex !important;
				align-items: center !important;
				justify-content: center !important;
			}
			.ui-datepicker-next span {
				display: flex !important;
				align-items: center !important;
				justify-content: center !important;
			}
		</style>
	</h:head>
	<h:body>
		<f:metadata>
			<f:event type="preRenderView" listener="#{createRide.checkAccess}" />
		</f:metadata>
		
		<h:form id="createForm">
			<h3>Create Ride</h3>
			
			<h:panelGroup rendered="#{not empty createRide.message}">
				<p styleClass="#{createRide.success ? 'message-success' : 'message-error'}">
					#{createRide.message}
				</p>
			</h:panelGroup>
			
			<h:panelGrid columns="2" style="margin-bottom: 20px;">
				<h:outputLabel value="Driver Email: " for="driverEmail" />
				<h:inputText id="driverEmail" value="#{createRide.driverEmail}" required="true" readonly="true" style="background-color: #e9ecef; color: #6c757d;" />
				
				<h:outputLabel value="From: " for="fromCity" />
				<h:panelGroup>
					<h:selectOneMenu id="fromCity" value="#{createRide.selectedFrom}">
						<f:selectItem itemLabel="-- Select City --" itemValue="" />
						<f:selectItems value="#{createRide.departingCities}" />
						<p:ajax event="change" update="customFromPanel toCity" process="@this" />
					</h:selectOneMenu>
					<h:panelGroup id="customFromPanel" style="display: block; margin-top: 5px;">
						<h:inputText id="customFrom" value="#{createRide.customFromCity}" 
									 rendered="#{createRide.selectedFrom eq 'Other'}" 
									 placeholder="Enter city name" 
									 style="width: 200px;" />
					</h:panelGroup>
				</h:panelGroup>
				
				<h:outputLabel value="To: " for="toCity" />
				<h:panelGroup>
					<h:selectOneMenu id="toCity" value="#{createRide.selectedTo}">
						<f:selectItem itemLabel="-- Select Destination --" itemValue="" />
						<f:selectItems value="#{createRide.destinationCities}" />
						<p:ajax event="change" update="customToPanel fromCity" process="@this" />
					</h:selectOneMenu>
					<h:panelGroup id="customToPanel" style="display: block; margin-top: 5px;">
						<h:inputText id="customTo" value="#{createRide.customToCity}" 
									 rendered="#{createRide.selectedTo eq 'Other'}" 
									 placeholder="Enter city name" 
									 style="width: 200px;" />
					</h:panelGroup>
				</h:panelGroup>
				
				<h:outputLabel value="Date: " for="dateCalendar" />
				<p:calendar id="dateCalendar" 
							value="#{createRide.selectedDate}" 
							navigator="true" 
							mode="inline"
							pattern="dd/MM/yyyy" />
				
				<h:outputLabel value="Number of Places: " for="nplaces" />
				<h:inputText id="nplaces" value="#{createRide.nplaces}" required="true">
					<f:convertNumber integerOnly="true" />
				</h:inputText>
				
				<h:outputLabel value="Price: " for="price" />
				<h:inputText id="price" value="#{createRide.price}" required="true">
					<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
				</h:inputText>
			</h:panelGrid>
			
			<p>
				<h:commandButton value="Create Ride" action="#{createRide.createRide}"
					style="font-size: 1em; padding: 0.5em 1em; margin-right: 10px;">
					<f:ajax execute="@form" render="@form" />
				</h:commandButton>
				<h:commandButton value="Back to Index" action="Index" immediate="true"
					style="font-size: 1em; padding: 0.5em 1em;" />
			</p>
		</h:form>
	</h:body>
</f:view>
</html>
